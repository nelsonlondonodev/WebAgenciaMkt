(()=>{function I(){let i=document.getElementById("darkModeToggle");if(i){let e=["auto","light","dark"],t=localStorage.getItem("theme")||"auto",s=r=>{if(r==="auto"){let o=window.matchMedia("(prefers-color-scheme: dark)").matches;document.documentElement.classList.toggle("dark",o)}else document.documentElement.classList.toggle("dark",r==="dark")},a=r=>{let o=i.querySelector("i");o&&(o.classList.remove("fa-sun","fa-moon","fa-circle-half-stroke"),r==="light"?o.classList.add("fa-sun"):r==="dark"?o.classList.add("fa-moon"):o.classList.add("fa-circle-half-stroke"))};i.addEventListener("click",()=>{let o=(e.indexOf(t)+1)%e.length;t=e[o],localStorage.setItem("theme",t),s(t),a(t)}),window.matchMedia("(prefers-color-scheme: dark)").addEventListener("change",()=>{t==="auto"&&s("auto")}),s(t),a(t)}}function L(){document.body.classList.add("fade-in");function i(t){let s=document.querySelector(t);if(s){let a=document.getElementById("mainHeader")?.offsetHeight||80,o=s.getBoundingClientRect().top+window.pageYOffset-a;window.scrollTo({top:o,behavior:"smooth"})}}function e(t,s){document.body.classList.add("fade-out"),setTimeout(()=>{s?(i(t),setTimeout(()=>{document.body.classList.remove("fade-out")},50)):window.location.href=t},300)}document.querySelectorAll('a:not([href^="tel:"]):not([href^="mailto:"]):not(.social-share-btn):not(.modal-contact-button):not([target="_blank"])').forEach(t=>{t.addEventListener("click",function(s){let a=this.getAttribute("href");if(!a||a==="#")return;let r=a.startsWith("#"),o=r||a.split("#")[0]===window.location.pathname.split("/").pop()||a.split("#")[0]==="";(this.hostname===window.location.hostname||a.startsWith("/"))&&(s.preventDefault(),e(a,r&&o))})})}function k(){let i=document.querySelectorAll(".scroll-animate-initial");if(i.length>0&&typeof IntersectionObserver<"u"){let e=new IntersectionObserver(t=>{t.forEach(s=>{s.isIntersecting&&(s.target.classList.add("is-visible"),e.unobserve(s.target))})},{threshold:.1});i.forEach((t,s)=>{t.style.transitionDelay=`${30*s}ms`,e.observe(t)})}}function q(){let i=document.createElement("div");return i.id="nav-overlay",i.className="fixed inset-0 bg-black/50 z-10 hidden",document.body.appendChild(i),i}function A(){let i=document.getElementById("mobileMenuButton"),e=document.getElementById("mobileMenu"),t=q();if(!i||!e)return;let s=i.querySelector("i"),a=()=>{e.classList.add("hidden"),t.classList.add("hidden"),s&&(s.classList.remove("fa-times"),s.classList.add("fa-bars"))},r=()=>{e.classList.remove("hidden"),t.classList.remove("hidden"),s&&(s.classList.remove("fa-bars"),s.classList.add("fa-times"))},o=()=>{e.classList.contains("hidden")?r():a()};i.addEventListener("click",n=>{n.stopPropagation(),o()}),t.addEventListener("click",a),e.addEventListener("click",n=>{n.target.closest("a")&&(n.target.closest("#mobileServicesButton")||a())})}function O(){let i=document.getElementById("mobileServicesButton"),e=document.getElementById("mobileServicesMenu");!i||!e||i.addEventListener("click",t=>{t.stopPropagation(),e.classList.toggle("hidden");let s=i.querySelector("i.fa-chevron-down");s&&s.classList.toggle("rotate-180")})}function H(){let i=document.querySelectorAll("section[id]"),e=document.querySelectorAll("header nav a");if(i.length===0||e.length===0)return;let t={root:null,rootMargin:"0px 0px -60% 0px",threshold:0},s=new IntersectionObserver(a=>{a.forEach(r=>{if(r.isIntersecting){let o=r.target.id;e.forEach(n=>{n.classList.remove("nav-active"),n.getAttribute("href")===`#${o}`&&n.classList.add("nav-active")})}})},t);i.forEach(a=>{s.observe(a)})}function D(){let i=document.getElementById("services-menu-group"),e=document.getElementById("services-menu-dropdown"),t;!i||!e||(i.addEventListener("mouseenter",()=>{clearTimeout(t),e.classList.remove("hidden")}),i.addEventListener("mouseleave",()=>{t=setTimeout(()=>{e.classList.add("hidden")},300)}))}function x(){A(),O(),H(),D()}function w(){let i=document.getElementById("portfolio-filters"),e=document.querySelectorAll("#portfolio-grid .portfolio-item");i&&e.length>0&&i.addEventListener("click",t=>{if(t.target.matches("button.filter-btn")){let s=t.target;if(s.classList.contains("active-filter"))return;i.querySelector(".active-filter").classList.remove("active-filter"),s.classList.add("active-filter");let a=s.dataset.filter;e.forEach(r=>{let o=r.dataset.category,n=a==="all"||o.includes(a);r.style.display=n?"block":"none"})}})}function P(i,e,t,s,a=0){let r=null;function o(n){r===null&&(r=n);let c=n-r,d=Math.min(c/s,1),l=e<t,m=t-e,f=e+m*d;d===1?i.textContent=parseFloat(t).toFixed(a):i.textContent=f.toFixed(a),d<1&&requestAnimationFrame(o)}requestAnimationFrame(o)}function S(){let i=document.querySelectorAll(".animate-number");if(i.length===0)return;let e=new IntersectionObserver((t,s)=>{t.forEach(a=>{if(a.isIntersecting){let r=a.target,o=parseFloat(r.dataset.endValue),n=parseFloat(r.dataset.startValue)||0,c=parseInt(r.dataset.duration,10)||2e3,d=parseInt(r.dataset.decimals,10)||0;if(isNaN(o)){console.error("El atributo data-end-value no es un n\xFAmero v\xE1lido.",r);return}P(r,n,o,c,d),s.unobserve(r)}})},{threshold:.5});i.forEach(t=>{e.observe(t)})}var h=async(i,e)=>{try{let t=await fetch(e);if(!t.ok)throw new Error(`Error al cargar el componente ${e}: ${t.statusText}`);let s=await t.text(),a=document.querySelector(i);a?a.innerHTML=s:console.warn(`No se encontr\xF3 el elemento con el selector: ${i}`)}catch(t){console.error(`No se pudo cargar el componente desde ${e}:`,t)}},B=async()=>{await Promise.all([h("#nav-placeholder","/components/nav.html"),h("#footer-placeholder","/components/footer.html"),h("#cookie-banner-placeholder","/components/cookie-banner.html")]),document.querySelector('[data-component="chatbot"]')&&await h('[data-component="chatbot"]',"/components/chatbot.html")};var M=()=>{let i=document.getElementById("currentYear");i&&(i.textContent=new Date().getFullYear())};var v=class{constructor(){this.elements={widgetButton:document.getElementById("chat-widget-button"),window:document.getElementById("chat-window"),closeButton:document.getElementById("close-chat-window"),sendButton:document.getElementById("chat-send"),input:document.getElementById("chat-input"),messages:document.getElementById("chat-messages")},this.elements.widgetButton&&(this.n8nWebhookUrl="https://n8n.srv1033442.hstgr.cloud/webhook/34b5ab96-ecf0-4195-93de-e3923c2062e5",this.sessionIdKey="nelson_chat_session_id",this.sessionId=this.getOrCreateSessionId(),this.historyKey=`nelson_chat_history_${this.sessionId}`,this.history=[],this.loadHistory(),this.addEventListeners())}getOrCreateSessionId(){let e=localStorage.getItem(this.sessionIdKey);return e||(e=Date.now().toString(36)+Math.random().toString(36).substring(2),localStorage.setItem(this.sessionIdKey,e)),e}loadHistory(){let e=sessionStorage.getItem(this.historyKey);e&&(this.history=JSON.parse(e),this.history.forEach(t=>{this.appendMessage(t.message,t.sender,!1)}))}addEventListeners(){this.elements.widgetButton.addEventListener("click",()=>this.toggleWindow()),this.elements.closeButton.addEventListener("click",()=>this.toggleWindow()),this.elements.sendButton.addEventListener("click",()=>this.sendMessage()),this.elements.input.addEventListener("keypress",e=>{e.key==="Enter"&&this.sendMessage()})}toggleWindow(){this.elements.window.classList.toggle("hidden"),this.elements.window.classList.contains("hidden")||(this.elements.input.focus(),this.history.length===0&&this.appendMessage("\xA1Hola! Soy Aurelio, tu asistente virtual. \xBFEn qu\xE9 puedo ayudarte?","bot"))}sendMessage(){let e=this.elements.input.value.trim();e!==""&&(this.appendMessage(e,"user"),this.elements.input.value="",this.showTypingIndicator(),this.sendToWebhook(e,this.sessionId))}async sendToWebhook(e,t){try{let a=await(await fetch(this.n8nWebhookUrl,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({message:e,sessionId:t})})).json();this.removeTypingIndicator();let r=a.response||"Lo siento, no he podido procesar tu mensaje. Por favor, intenta de nuevo.";this.appendMessage(r,"bot")}catch(s){console.error("Error sending message to n8n:",s),this.removeTypingIndicator(),this.appendMessage("Lo siento, ha ocurrido un error de conexi\xF3n. Por favor, int\xE9ntalo m\xE1s tarde.","bot")}}createBubble(e,t){let s=document.createElement("div");return s.className=`py-2 px-4 inline-block max-w-xs ${t==="user"?"bg-primary-blue text-white rounded-t-lg rounded-bl-lg":"bg-gray-200 dark:bg-gray-700 text-gray-900 dark:text-white rounded-t-lg rounded-br-lg"}`,s.innerHTML=e,s.querySelectorAll("a").forEach(a=>a.classList.add("text-blue-500","underline")),s}createTimestamp(){let e=new Date().toLocaleTimeString("es-ES",{hour:"2-digit",minute:"2-digit"}),t=document.createElement("div");return t.className="text-xs text-gray-500 dark:text-gray-400 mt-1",t.textContent=e,t}appendMessage(e,t,s=!0){s&&(this.history.push({message:e,sender:t}),sessionStorage.setItem(this.historyKey,JSON.stringify(this.history)));let a=document.createElement("div");a.className=`mb-4 flex flex-col ${t==="user"?"items-end":"items-start"} animate-chat-message-in`;let r=this.createBubble(e,t),o=this.createTimestamp();a.appendChild(r),a.appendChild(o),this.elements.messages.appendChild(a),this.elements.messages.scrollTop=this.elements.messages.scrollHeight}showTypingIndicator(){let e=document.createElement("div");e.id="typing-indicator",e.className="mb-4",e.innerHTML=`
      <div class="bg-gray-200 dark:bg-gray-700 rounded-lg py-2 px-4 inline-block">
        <div class="flex items-center space-x-1">
          <span class="w-2 h-2 bg-gray-500 rounded-full animate-pulse"></span>
          <span class="w-2 h-2 bg-gray-500 rounded-full animate-pulse" style="animation-delay: 0.2s;"></span>
          <span class="w-2 h-2 bg-gray-500 rounded-full animate-pulse" style="animation-delay: 0.4s;"></span>
        </div>
      </div>`,this.elements.messages.appendChild(e),this.elements.messages.scrollTop=this.elements.messages.scrollHeight}removeTypingIndicator(){let e=document.getElementById("typing-indicator");e&&e.remove()}};function C(){new v}document.addEventListener("DOMContentLoaded",async()=>{await B(),I(),L(),k(),x(),w(),S(),M(),C(),i();function i(){function o(l){if(l){let m=l.querySelector("iframe[data-src]");m&&!m.src&&(m.src=m.dataset.src),l.classList.remove("hidden"),l.classList.add("flex"),document.body.classList.add("overflow-hidden")}}function n(l){l&&(l.classList.add("hidden"),l.classList.remove("flex"),document.body.classList.remove("overflow-hidden"))}[{cardId:"card-proyecto-locutorio",modalId:"proyecto-modal-locutorio"},{cardId:"card-proyecto-barberia",modalId:"proyecto-modal-barberia"},{cardId:"card-proyecto-kuula",modalId:"proyecto-modal-kuula"}].forEach(l=>{let m=document.getElementById(l.cardId),f=document.getElementById(l.modalId);m&&f&&m.addEventListener("click",()=>o(f))});let d=document.querySelectorAll('[id^="service-modal-"], [id^="proyecto-modal-"]');d.length>0&&(d.forEach(l=>{let m=l.querySelector('button[id^="close-modal-"]');m&&m.addEventListener("click",()=>n(l)),l.addEventListener("click",f=>{f.target===l&&n(l)}),l.querySelectorAll(".modal-contact-button").forEach(f=>{f.addEventListener("click",()=>n(l))})}),window.addEventListener("keydown",l=>{l.key==="Escape"&&d.forEach(m=>{m.classList.contains("hidden")||n(m)})}))}e();function e(){let o=document.querySelector("#contact-form");if(o){let n=document.getElementById("form-status"),c=o.querySelector('button[type="submit"]');o.addEventListener("submit",async function(d){if(d.preventDefault(),!o.checkValidity()){o.reportValidity(),n&&(n.textContent="Por favor, completa todos los campos requeridos.",n.className="text-center font-semibold mt-4 text-red-600",setTimeout(()=>{n.textContent=""},5e3));return}let l=new FormData(o);n&&(n.textContent="Enviando...",n.className="text-center font-semibold mt-4 text-gray-600 dark:text-gray-300"),c&&(c.disabled=!0);try{(await fetch(o.action,{method:"POST",body:l,headers:{Accept:"application/json"}})).ok?(n&&(n.textContent="\xA1Mensaje enviado con \xE9xito!",n.className="text-center font-semibold mt-4 text-green-600",setTimeout(()=>{n.textContent=""},5e3)),o.reset()):n&&(n.textContent="Hubo un error al enviar el mensaje. Int\xE9ntalo de nuevo.",n.className="text-center font-semibold mt-4 text-red-600",setTimeout(()=>{n.textContent=""},5e3))}catch{n&&(n.textContent="Hubo un problema de conexi\xF3n. Revisa tu internet.",n.className="text-center font-semibold mt-4 text-red-600",setTimeout(()=>{n.textContent=""},5e3))}finally{c&&setTimeout(()=>{c.disabled=!1},3e3)}})}}t();function t(){if(document.getElementById("contact-reveal-container")){let n=document.getElementById("reveal-email-btn"),c=document.getElementById("reveal-phone-btn");n&&n.addEventListener("click",d=>{d.currentTarget.outerHTML=`
          <a href="mailto:contacto@nelsonlondono.es" class="text-primary-blue dark:text-primary-green font-semibold hover:underline flex items-center">
            <i class="fas fa-envelope mr-2"></i>contacto@nelsonlondono.es
          </a>`},{once:!0}),c&&c.addEventListener("click",d=>{d.currentTarget.outerHTML=`
          <a href="tel:+34663975428" class="text-primary-blue dark:text-primary-green font-semibold hover:underline flex items-center">
            <i class="fas fa-phone mr-2"></i>+34 663 97 54 28
          </a>`},{once:!0})}}s();function s(){let o="nelson_cookie_consent",n=document.getElementById("cookie-banner"),c=document.getElementById("cookie-settings-modal"),d=document.getElementById("analytics-cookie-toggle"),l=document.getElementById("open-cookie-settings"),m=document.getElementById("cookie-accept"),f=document.getElementById("cookie-reject"),b=document.getElementById("cookie-settings-open"),E=document.getElementById("cookie-settings-save");function g(){let u=localStorage.getItem(o);return u?JSON.parse(u):null}function p(u){localStorage.setItem(o,JSON.stringify(u))}function y(){typeof gtag=="function"&&gtag("config","G-124QEKRXHD")}function T(){let u=g();u?(u.analytics&&y(),n&&n.classList.add("hidden")):n&&n.classList.remove("hidden")}l&&l.addEventListener("click",u=>{u.preventDefault();let N=g()||{analytics:!1};d&&(d.checked=N.analytics),c&&c.classList.remove("hidden")}),m&&m.addEventListener("click",()=>{p({necessary:!0,analytics:!0}),y(),n&&n.classList.add("hidden")}),f&&f.addEventListener("click",()=>{p({necessary:!0,analytics:!1}),n&&n.classList.add("hidden")}),b&&b.addEventListener("click",()=>{let u=g()||{analytics:!1};d&&(d.checked=u.analytics),c&&c.classList.remove("hidden")}),E&&E.addEventListener("click",()=>{let u={necessary:!0,analytics:d?d.checked:!1};p(u),u.analytics&&y(),c&&c.classList.add("hidden"),n&&n.classList.add("hidden")}),c&&c.addEventListener("click",u=>{u.target===c&&c.classList.add("hidden")}),T()}a();function a(){let o=document.getElementById("hero-iframe-container");o&&o.addEventListener("click",()=>{let n=document.getElementById("hero-iframe-placeholder"),c=document.getElementById("hero-iframe");c&&c.dataset.src&&(c.src=c.dataset.src,n&&n.classList.add("hidden"),c.classList.remove("hidden"),o.style.cursor="default")},{once:!0})}function r(){let o=document.getElementById("share-linkedin"),n=document.getElementById("share-whatsapp");if(o&&n){let c=window.location.href,d=document.title,l=document.querySelector('meta[name="description"]').getAttribute("content");c&&d&&l&&(o.href=`https://www.linkedin.com/shareArticle?mini=true&url=${encodeURIComponent(c)}&title=${encodeURIComponent(d)}&summary=${encodeURIComponent(l)}`,o.target="_blank",o.rel="noopener noreferrer",n.href=`https://api.whatsapp.com/send?text=${encodeURIComponent(d+" - Link: "+c)}`,n.target="_blank",n.rel="noopener noreferrer")}}r()});})();
