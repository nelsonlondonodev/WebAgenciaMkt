import{initTranslations}from"./translations.js";import{initDarkMode}from"./darkMode.js";import{initSmoothScroll}from"./smoothScroll.js";import{initScrollAnimations}from"./scrollAnimations.js";import{initNav}from"./nav.js";import{initPortfolio}from"./portfolio.js";import{initChat}from"./chat.js";document.addEventListener("DOMContentLoaded",()=>{function e(e){e&&(e.classList.add("hidden"),e.classList.remove("flex"),document.body.classList.remove("overflow-hidden"))}initTranslations(),initDarkMode(),initSmoothScroll(),initScrollAnimations(),initNav(),initPortfolio(),initChat();[{cardId:"card-proyecto-locutorio",modalId:"proyecto-modal-locutorio"},{cardId:"card-proyecto-barberia",modalId:"proyecto-modal-barberia"},{cardId:"card-proyecto-kuula",modalId:"proyecto-modal-kuula"},{cardId:"card-tours-virtuales",modalId:"service-modal-tours"},{cardId:"card-web-medida",modalId:"service-modal-web-medida"},{cardId:"card-wordpress",modalId:"service-modal-wordpress"},{cardId:"card-seo",modalId:"service-modal-seo"},{cardId:"card-branding",modalId:"service-modal-branding"}].forEach(e=>{const t=document.getElementById(e.cardId),n=document.getElementById(e.modalId);t&&n&&t.addEventListener("click",()=>function(e){if(e){const t=e.querySelector("iframe[data-src]");t&&!t.src&&(t.src=t.dataset.src),e.classList.remove("hidden"),e.classList.add("flex"),document.body.classList.add("overflow-hidden")}}(n))});const t=document.querySelectorAll('[id^="service-modal-"], [id^="proyecto-modal-"]');t.length>0&&(t.forEach(t=>{const n=t.querySelector('button[id^="close-modal-"]');n&&n.addEventListener("click",()=>e(t)),t.addEventListener("click",n=>{n.target===t&&e(t)}),t.querySelectorAll(".modal-contact-button").forEach(n=>{n.addEventListener("click",()=>e(t))})}),window.addEventListener("keydown",n=>{"Escape"===n.key&&t.forEach(t=>{t.classList.contains("hidden")||e(t)})}));const n=document.querySelector("form[action='https://formspree.io/f/xanjbdrp']");if(n){const e=document.getElementById("form-status"),t=n.querySelector('button[type="submit"]');n.addEventListener("submit",async function(o){if(o.preventDefault(),!n.checkValidity())return n.reportValidity(),void(e&&(e.textContent="Por favor, completa todos los campos requeridos.",e.className="text-center font-semibold mt-4 text-red-600",setTimeout(()=>{e.textContent=""},5e3)));const a=new FormData(n);e&&(e.textContent="Enviando...",e.className="text-center font-semibold mt-4 text-gray-600 dark:text-gray-300"),t&&(t.disabled=!0);try{(await fetch(n.action,{method:"POST",body:a,headers:{Accept:"application/json"}})).ok?(e&&(e.textContent="¡Mensaje enviado con éxito!",e.className="text-center font-semibold mt-4 text-green-600",setTimeout(()=>{e.textContent=""},5e3)),n.reset()):e&&(e.textContent="Hubo un error al enviar el mensaje. Inténtalo de nuevo.",e.className="text-center font-semibold mt-4 text-red-600",setTimeout(()=>{e.textContent=""},5e3))}catch(t){e&&(e.textContent="Hubo un problema de conexión. Revisa tu internet.",e.className="text-center font-semibold mt-4 text-red-600",setTimeout(()=>{e.textContent=""},5e3))}finally{t&&setTimeout(()=>{t.disabled=!1},3e3)}})}if(document.getElementById("contact-reveal-container")){const e=document.getElementById("reveal-email-btn"),t=document.getElementById("reveal-phone-btn");e&&e.addEventListener("click",e=>{e.currentTarget.outerHTML='\n          <a href="mailto:contacto@nelsonlondono.es" class="text-primary-blue dark:text-primary-green font-semibold hover:underline flex items-center">\n            <i class="fas fa-envelope mr-2"></i>contacto@nelsonlondono.es\n          </a>'},{once:!0}),t&&t.addEventListener("click",e=>{e.currentTarget.outerHTML='\n          <a href="tel:+34663975428" class="text-primary-blue dark:text-primary-green font-semibold hover:underline flex items-center">\n            <i class="fas fa-phone mr-2"></i>+34 663 97 54 28\n          </a>'},{once:!0})}const o="nelson_cookie_consent",a=document.getElementById("cookie-banner"),d=document.getElementById("cookie-settings-modal"),c=document.getElementById("analytics-cookie-toggle"),r=document.getElementById("open-cookie-settings"),i=document.getElementById("cookie-accept"),s=document.getElementById("cookie-reject"),l=document.getElementById("cookie-settings-open"),m=document.getElementById("cookie-settings-save");function u(){const e=localStorage.getItem(o);return e?JSON.parse(e):null}function f(e){localStorage.setItem(o,JSON.stringify(e))}function y(){"function"==typeof gtag&&gtag("config","G-124QEKRXHD")}r&&r.addEventListener("click",e=>{e.preventDefault();const t=u()||{analytics:!1};c&&(c.checked=t.analytics),d&&d.classList.remove("hidden")}),i&&i.addEventListener("click",()=>{f({necessary:!0,analytics:!0}),y(),a&&a.classList.add("hidden")}),s&&s.addEventListener("click",()=>{f({necessary:!0,analytics:!1}),a&&a.classList.add("hidden")}),l&&l.addEventListener("click",()=>{const e=u()||{analytics:!1};c&&(c.checked=e.analytics),d&&d.classList.remove("hidden")}),m&&m.addEventListener("click",()=>{const e={necessary:!0,analytics:!!c&&c.checked};f(e),e.analytics&&y(),d&&d.classList.add("hidden"),a&&a.classList.add("hidden")}),d&&d.addEventListener("click",e=>{e.target===d&&d.classList.add("hidden")}),function(){const e=u();e?(e.analytics&&y(),a&&a.classList.add("hidden")):a&&a.classList.remove("hidden")}();const p=document.getElementById("hero-iframe-container");p&&p.addEventListener("click",()=>{const e=document.getElementById("hero-iframe-placeholder"),t=document.getElementById("hero-iframe");t&&t.dataset.src&&(t.src=t.dataset.src,e&&e.classList.add("hidden"),t.classList.remove("hidden"),p.style.cursor="default")},{once:!0}),function(){const e=document.getElementById("share-linkedin"),t=document.getElementById("share-whatsapp");if(e&&t){const n=window.location.href,o=document.title,a=document.querySelector('meta[name="description"]').getAttribute("content");n&&o&&a&&(e.href=`https://www.linkedin.com/shareArticle?mini=true&url=${encodeURIComponent(n)}&title=${encodeURIComponent(o)}&summary=${encodeURIComponent(a)}`,e.target="_blank",e.rel="noopener noreferrer",t.href=`https://api.whatsapp.com/send?text=${encodeURIComponent(o+" - Link: "+n)}`,t.target="_blank",t.rel="noopener noreferrer")}}()});